<!DOCTYPE html>
<html lang="id">
<head>
    <meta name="google-site-verification" content="pz72A_SOUbG4L7dPVTVI81N2NCn6mhxR7WBHsYVQMho" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>PAI B IAINU Kebumen Official 2025</title>
    
    <meta name="description" content="Website Resmi Kelas PAI B Angkatan 2025 Fakultas Tarbiyah IAINU Kebumen. Galeri, Struktur Organisasi, dan Dokumentasi Kegiatan Mahasiswa.">
    <meta name="keywords" content="PAI B, IAINU Kebumen, Kelas PAI B 2025, Fakultas Tarbiyah, Mahasiswa Kebumen">
    <meta name="theme-color" content="#000000">
    
    <meta property="og:site_name" content="PAI B Official IAINU Kebumen">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://paib-official.com/"> 
    <meta property="og:title" content="PAI B Official - IAINU Kebumen">
    <meta property="og:description" content="Website Resmi Keluarga Besar PAI B 2025. One Heart, One Goal.">
    <meta property="og:image" content="PAI B.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="PAI B Official - IAINU Kebumen">
    <meta name="twitter:description" content="Website Resmi Keluarga Besar PAI B 2025. One Heart, One Goal.">
    <meta name="twitter:image" content="PAI B.jpg">

    <meta itemprop="image" content="PAI B.jpg">

    <script type="application/ld+json">
    [
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "PAI B Official",
        "url": "https://paib-official.com", 
        "logo": "PAI B.jpg",
        "sameAs": [
          "https://www.instagram.com/iainukebumen/",
          "https://twitter.com/iainu_kebumen"
        ]
      },
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "PAI B Official IAINU Kebumen",
        "alternateName": ["PAI B 2025", "PAI B Kebumen"],
        "url": "https://paib-official.com"
      }
    ]
    </script>

    <link rel="icon" type="image/jpeg" href="PAI B.jpg">
    <link rel="shortcut icon" type="image/jpeg" href="PAI B.jpg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'crimson-dark': '#1a0505',
                        'crimson-main': '#8a0000',
                        'crimson-light': '#ff1f1f',
                        'glass': 'rgba(255, 255, 255, 0.05)',
                    },
                    fontFamily: {
                        'tech': ['Orbitron', 'sans-serif'],
                        'body': ['Poppins', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'bounce-slow': 'bounce 3s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #0a0000;
            color: #e5e5e5;
            overflow-x: hidden;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a0505;
        }
        ::-webkit-scrollbar-thumb {
            background: #8a0000;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #ff1f1f;
        }

        .glass-panel {
            background: rgba(40, 0, 0, 0.6);
            border: 1px solid rgba(255, 50, 50, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            transform: translateZ(0); 
            -webkit-transform: translateZ(0);
        }

        @media (min-width: 768px) {
            .glass-panel {
                background: rgba(40, 0, 0, 0.4);
                backdrop-filter: blur(12px);
                -webkit-backdrop-filter: blur(12px);
            }
        }

        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000000, #2b0000);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            transition: transform 0.8s ease-in-out, opacity 0.8s ease-in-out;
            will-change: transform, opacity;
        }

        /* --- PAGE TRANSITION LOADER --- */
        #page-loader {
            position: fixed;
            inset: 0;
            z-index: 9990; /* High z-index but below auth modal */
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        #page-loader.active {
            opacity: 1;
            pointer-events: auto;
        }

        .hidden-section {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .active-section {
            display: block;
            animation: fadeIn 0.6s forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .neon-text {
            text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 20px #8a0000;
        }

        /* --- TREE CSS (TREE LAYOUT FOR ALL SCREENS) --- */
        .tree {
            display: table; /* Ensures tree structure holds together */
            margin: 0 auto;
            width: max-content; /* Forces width to fit content (enables horizontal scroll if needed) */
            min-width: 100%;
            padding-bottom: 50px;
        }
        .tree ul {
            padding-top: 20px; 
            position: relative;
            transition: all 0.5s;
            display: flex;
            justify-content: center;
        }
        
        .tree li {
            float: left; 
            text-align: center;
            list-style-type: none;
            position: relative;
            padding: 20px 2px 0 2px; /* Very small padding on mobile to save space */
            transition: all 0.5s;
        }
        
        /* Desktop padding adjustment */
        @media (min-width: 768px) {
            .tree li {
                padding: 20px 10px 0 10px;
            }
        }
        
        /* Tree Lines (Global) */
        .tree li::before, .tree li::after {
            content: '';
            position: absolute; top: 0; right: 50%;
            border-top: 2px solid #8a0000;
            width: 50%; height: 20px;
        }
        .tree li::after {
            right: auto; left: 50%;
            border-left: 2px solid #8a0000;
        }
        .tree li:only-child::after, .tree li:only-child::before {
            display: none;
        }
        .tree li:only-child { padding-top: 0;}
        .tree li:first-child::before, .tree li:last-child::after {
            border: 0 none;
        }
        .tree li:last-child::before{
            border-right: 2px solid #8a0000;
            border-radius: 0 5px 0 0;
        }
        .tree li:first-child::after{
            border-radius: 5px 0 0 0;
        }
        .tree ul ul::before{
            content: '';
            position: absolute; top: 0; left: 50%;
            border-left: 2px solid #8a0000;
            width: 0; height: 20px;
        }

        /* Container Scroll */
        #structure-content-container {
            width: 100%;
            overflow-x: auto; /* Enable horizontal scroll */
            padding-bottom: 2rem;
            display: block; /* Change flex to block to allow scrolling child */
        }
        
        /* Modal & Overlay Fixes */
        .fullscreen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 0, 0, 0.95);
            z-index: 100;
            overflow: auto; /* Scroll both directions if needed */
            transform: scale(0.9);
            opacity: 0;
            pointer-events: none;
            transition: transform 0.3s ease, opacity 0.3s ease;
            will-change: transform, opacity;
        }
        
        .fullscreen-overlay.open {
            transform: scale(1);
            opacity: 1;
            pointer-events: auto;
        }
        .fullscreen-overlay.open .tree {
            /* Force re-render/layout calc if needed */
            width: max-content;
        }
        .fullscreen-overlay:focus {
            outline: none;
        }

        .custom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9); 
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            will-change: opacity;
        }
        .custom-modal.active {
            opacity: 1;
            pointer-events: auto;
        }
        #bio-content:focus {
            outline: none;
        }

        .bio-info-row {
            display: flex;
            align-items: flex-start;
            gap: 1.25rem; 
            padding: 0.5rem 0;
            transition: background-color 0.3s;
        }
        .bio-icon-box {
            flex-shrink: 0;
            width: 3rem; 
            height: 3rem; 
            border-radius: 50%;
            background: rgba(127, 29, 29, 0.2); 
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ef4444; 
            font-size: 1.25rem; 
            border: 1px solid rgba(239, 68, 68, 0.1);
            transition: transform 0.3s, background-color 0.3s, color 0.3s;
        }
        .bio-info-row:hover .bio-icon-box {
            background: #dc2626; 
            color: white;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.4);
        }
        
        .music-pulse {
            animation: musicPulse 1.5s infinite;
        }
        @keyframes musicPulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
        }

        .play-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: rgba(220, 38, 38, 0.85);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            transition: transform 0.3s, background-color 0.3s;
            box-shadow: 0 0 25px rgba(220, 38, 38, 0.6);
            z-index: 10;
        }
        .group:hover .play-overlay {
            background: rgba(255, 255, 255, 0.95);
            color: #dc2626;
            transform: translate(-50%, -50%) scale(1.15);
        }

        .img-loading-skeleton {
            position: absolute;
            inset: 0;
            background-color: #1f2937; 
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0;
        }
        .img-loaded {
            opacity: 1 !important;
        }

        /* Struktur Loading Overlay */
        #structure-loading-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.9); /* Darker background */
            backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #structure-loading-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        
        .semester-btn {
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        /* Animation for Error Cross */
        @keyframes drawCross {
            0% { stroke-dasharray: 0 100; opacity: 0; }
            50% { opacity: 1; }
            100% { stroke-dasharray: 100 100; opacity: 1; }
        }
        .animate-cross path {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: dash 0.5s cubic-bezier(0.4, 0, 0.6, 1) forwards;
        }
        @keyframes dash {
            to { stroke-dashoffset: 0; }
        }
        .shake-horizontal {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="font-body selection:bg-red-500 selection:text-white" oncontextmenu="return false;" ondragstart="return false;" onselectstart="return false;">

    <audio id="bg-music" loop>
        <source src="Qolbi Fil Madinah.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- NEW PAGE TRANSITION LOADER -->
    <div id="page-loader">
        <div class="w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin"></div>
        <p class="mt-4 text-red-500 font-tech tracking-widest text-sm animate-pulse">MEMUAT...</p>
    </div>

    <div id="intro-screen">
        <!-- Intro content unchanged -->
        <div class="text-center">
            <h1 class="font-tech text-4xl md:text-7xl font-bold text-white mb-4 tracking-widest neon-text">
                PRODI <span id="typing-text" class="text-red-500 typing-cursor"></span>
            </h1>
            <p class="text-gray-400 text-sm md:text-lg mb-8 font-light tracking-[0.3em]">2025 | GENERATION OF SUCCESS</p>
            
            <button onclick="enterSite()" class="group relative px-8 py-3 bg-transparent overflow-hidden rounded-full border border-red-600 transition-all hover:shadow-[0_0_20px_rgba(255,0,0,0.5)]">
                <span class="relative z-10 text-white font-tech tracking-wider group-hover:text-black transition-colors duration-300">VISIT CLASS</span>
                <div class="absolute inset-0 h-full w-full scale-0 rounded-full transition-all duration-300 group-hover:scale-100 group-hover:bg-red-600"></div>
            </button>
        </div>
    </div>

    <div id="main-app" class="hidden opacity-0 transition-opacity duration-1000 min-h-screen flex flex-col">
        <!-- Nav unchanged -->
        <nav class="fixed top-0 w-full z-50 glass-panel border-b border-red-900/30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex-shrink-0 cursor-pointer" onclick="switchTab('home')">
                        <span class="font-tech text-2xl font-bold text-red-500 tracking-tighter">PAI <span class="text-white">B</span></span>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <button onclick="switchTab('home')" class="nav-btn text-white hover:text-red-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Home</button>
                            <button onclick="switchTab('structure')" class="nav-btn text-gray-300 hover:text-red-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Structure</button>
                            <button onclick="switchTab('documentation')" class="nav-btn text-gray-300 hover:text-red-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Documentation</button>
                            <button onclick="switchTab('finance')" class="nav-btn text-gray-300 hover:text-red-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Keuangan</button>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <button onclick="toggleMusic()" id="music-btn" class="w-8 h-8 rounded-full bg-red-900/50 flex items-center justify-center text-red-400 border border-red-500/30 hover:bg-red-600 hover:text-white transition-all music-pulse">
                            <i class="fas fa-music"></i>
                        </button>
                        <div class="md:hidden">
                            <button id="mobile-menu-btn" onclick="toggleMobileMenu()" class="text-gray-300 hover:text-white p-2">
                                <i class="fas fa-bars text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- FIXED MOBILE MENU ANIMATION -->
            <div id="mobile-menu" class="md:hidden absolute top-16 left-0 w-full bg-black/95 backdrop-blur-md border-b border-red-900/30 overflow-hidden transition-all duration-300 ease-in-out max-h-0 opacity-0">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <button onclick="switchTab('home')" class="text-gray-300 hover:text-red-400 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Home</button>
                    <button onclick="switchTab('structure')" class="text-gray-300 hover:text-red-400 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Structure</button>
                    <button onclick="switchTab('documentation')" class="text-gray-300 hover:text-red-400 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Documentation</button>
                    <button onclick="switchTab('finance')" class="text-gray-300 hover:text-red-400 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Keuangan</button>
                </div>
            </div>
        </nav>

        <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
            <div class="absolute inset-0 bg-gradient-to-b from-black via-[#1a0000] to-black opacity-80"></div>
            
            <div class="hidden md:block absolute top-[-10%] left-[-10%] w-96 h-96 bg-red-900 rounded-full mix-blend-multiply filter blur-[100px] opacity-30 animate-pulse-slow" style="will-change: transform, opacity;"></div>
            <div class="hidden md:block absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-red-800 rounded-full mix-blend-multiply filter blur-[100px] opacity-30 animate-pulse-slow" style="will-change: transform, opacity;"></div>
        </div>

        <main class="flex-grow pt-20 px-4 md:px-8 max-w-7xl mx-auto w-full">

            <section id="home" class="active-section py-10">
                <!-- Home section unchanged -->
                <div class="grid md:grid-cols-2 gap-10 items-center">
                    <div class="space-y-6 text-center md:text-left">
                        <div class="md:hidden mb-4 flex justify-center">
                            <img src="IAINU.jpg" alt="Class Logo Mobile" 
                                 class="w-30 h-30 object-contain filter drop-shadow-[0_0_10px_rgba(220,38,38,0.5)]"
                                 onerror="this.style.display='none'">
                        </div>

                        <h2 class="text-5xl md:text-6xl font-bold font-tech leading-tight">
                            WELCOME TO <br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-orange-600">FACULTY TARBIYAH</span>
                        </h2>
                        <p class="text-gray-400 leading-relaxed text-lg">
                            "Kami tidak hanya diajarkan cara mentransfer ilmu, tapi juga cara menanamkan adab. Karena ilmu tanpa adab seperti api tanpa kayu bakar, tak akan memberi kehangatan yang lama."
                        </p>
                        <div class="flex gap-4 pt-4 justify-center md:justify-start">
                            <button onclick="switchTab('documentation')" class="px-6 py-3 bg-red-700 hover:bg-red-600 rounded-lg text-white font-semibold transition-all shadow-[0_0_15px_rgba(220,38,38,0.5)]">
                                Let's Go !!!
                            </button>
                            <button onclick="switchTab('structure')" class="px-6 py-3 border border-gray-600 hover:border-red-500 hover:text-red-400 rounded-lg text-gray-300 font-semibold transition-all">
                                Mahasiswa
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4 pt-8 border-t border-gray-800">
                            <div>
                                <h3 class="text-2xl font-bold text-white">24</h3>
                                <p class="text-xs text-gray-500 uppercase tracking-wider">Siswa</p>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-white">6</h3>
                                <p class="text-xs text-gray-500 uppercase tracking-wider">Laki-laki</p>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-white">18</h3>
                                <p class="text-xs text-gray-500 uppercase tracking-wider">Perempuan</p>
                            </div>
                        </div>
                    </div>

                    <div class="relative animate-float hidden md:block">
                        <div class="flex justify-center mb-6">
                            <img src="IAINU.jpg" alt="Class Logo" 
                                 class="w-32 h-32 object-contain filter drop-shadow-[0_0_15px_rgba(220,38,38,0.5)] hover:scale-110 transition-transform duration-300"
                                 onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/2997/2997322.png';">
                        </div>

                        <div class="glass-panel p-8 rounded-2xl transform rotate-3 hover:rotate-0 transition-all duration-500 border border-red-500/20">
                            <div class="flex items-center gap-4 mb-6">
                                <div class="w-12 h-12 rounded-full bg-gradient-to-br from-red-500 to-black flex items-center justify-center">
                                    <i class="fas fa-quote-left text-white"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg">Motto Kelas</h4>
                                    <p class="text-xs text-red-400">Since 2025</p>
                                </div>
                            </div>
                            <blockquote class="text-xl font-light italic text-gray-300 mb-6">
                                "Microteaching itu memang mendebarkan, tapi lebih mendebarkan lagi kalau melihat generasi muda rusak karena kurangnya pendidikan karakter."
                            </blockquote>
                            <div class="flex justify-between items-center text-sm text-gray-500">
                                <span>PAI B Family</span>
                                <i class="fas fa-fingerprint text-red-500 text-2xl"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="structure" class="hidden-section py-10 relative min-h-[600px]">
                <!-- Semester Navigation -->
                <div class="mb-12">
                    <div class="text-center mb-6">
                        <h2 class="text-3xl md:text-5xl font-tech font-bold text-white mb-2">STRUKTUR KELAS</h2>
                        <div class="h-1 w-20 bg-red-600 mx-auto rounded-full"></div>
                    </div>
                    
                    <div class="max-w-4xl mx-auto px-4 flex justify-center">
                        <!-- Updated Semester Nav with Fixed Arrow Positioning and z-index -->
                        <div class="relative w-full max-w-sm flex items-center justify-center bg-black/40 h-16 rounded-full border border-red-900/30 backdrop-blur-sm">
                            <button onclick="prevSemester()" id="btn-prev-sem" class="absolute left-4 z-20 text-2xl md:text-3xl text-red-600 hover:text-white transition-all transform active:scale-90 focus:outline-none">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            
                            <div class="text-center w-full relative z-10">
                                <h3 id="current-semester-display" class="font-tech text-2xl md:text-3xl text-white font-bold tracking-widest drop-shadow-[0_0_10px_rgba(220,38,38,0.8)] transition-all">
                                    SEMESTER I
                                </h3>
                            </div>

                            <button onclick="nextSemester()" id="btn-next-sem" class="absolute right-4 z-20 text-2xl md:text-3xl text-red-600 hover:text-white transition-all transform active:scale-90 focus:outline-none">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Content Container with Relative Positioning for Loader -->
                <div class="relative min-h-[60vh]">
                    <!-- Loading Overlay -->
                    <div id="structure-loading-overlay">
                        <div class="flex flex-col items-center">
                            <div class="w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin-slow mb-4 shadow-[0_0_15px_rgba(220,38,38,0.5)]"></div>
                            <div class="text-red-500 font-tech text-lg tracking-widest animate-pulse" id="structure-loader-text">Beralih...</div>
                        </div>
                    </div>

                    <!-- Structure Content Container (Dynamic Injection) -->
                    <div id="structure-content-container">
                        <!-- Initial Content (Semester I) will be injected via JS on load -->
                    </div>
                </div>

                <div class="text-center pb-12 mt-8 flex flex-col gap-4 items-center">
                     <!-- Team Executor Button -->
                     <button id="btn-team-executor" onclick="toggleTeamExecutor()" class="px-6 py-2 bg-gray-900 border border-gray-600 hover:border-red-500 rounded-full text-xs font-bold tracking-wider text-gray-300 hover:text-white transition-all shadow-md hidden">
                        <i class="fas fa-sitemap mr-2"></i> TEAM EXECUTOR
                    </button>

                    <!-- Family Button -->
                    <button onclick="toggleFamilyGallery()" class="group relative px-10 py-4 bg-gradient-to-r from-red-900 to-black overflow-hidden rounded-xl border border-red-600/50 shadow-[0_0_30px_rgba(220,38,38,0.2)] hover:shadow-[0_0_50px_rgba(220,38,38,0.6)] transition-all duration-300">
                        <div class="flex items-center gap-3 relative z-10">
                            <i class="fas fa-users text-2xl text-red-400 group-hover:text-white transition-colors"></i>
                            <span class="font-tech text-xl font-bold text-white tracking-widest">FAMILY PAI B</span>
                        </div>
                        <div class="absolute inset-0 bg-red-600 opacity-0 group-hover:opacity-20 transition-opacity duration-300"></div>
                    </button>
                    <p class="text-gray-500 text-sm">Klik untuk melihat seluruh anggota keluarga kelas</p>
                </div>
            </section>

            <section id="documentation" class="hidden-section py-10">
                <!-- Doc section unchanged -->
                <div class="text-center mb-10">
                    <h2 class="text-3xl md:text-5xl font-tech font-bold text-white mb-2">ARCHIVES</h2>
                    <div class="h-1 w-20 bg-red-600 mx-auto rounded-full mb-4"></div>
                    <p class="text-gray-400 mb-6">Class Memories & Moments</p>
                    
                    <div class="flex flex-col md:flex-row justify-center items-center gap-3 max-w-xl mx-auto">
                        <div class="relative w-full">
                            <input type="text" id="doc-search" placeholder="Search by title..." 
                                   onkeyup="handleSearch(event)"
                                   class="w-full bg-black/40 border border-red-500/30 rounded-lg px-4 py-2 text-white text-sm focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 placeholder-gray-500 transition-all text-center md:text-left">
                            <button onclick="handleSearch({key: 'Enter'})" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <button onclick="openAllFiles()" class="w-full md:w-auto bg-red-900/30 hover:bg-red-800 border border-red-500/50 text-white px-6 py-2 rounded-lg text-sm transition-all whitespace-nowrap flex items-center justify-center gap-2">
                            <i class="fas fa-th-large"></i> All Files
                        </button>
                    </div>
                </div>

                <div id="documentation-grid" class="columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6">
                </div>
            </section>

            <!-- FINANCE SECTION -->
            <section id="finance" class="hidden-section py-10 min-h-[600px] flex justify-center items-center">
                
                <!-- LOGIN CONTAINER -->
                <div id="finance-login" class="max-w-md w-full px-4">
                    <div class="glass-panel p-8 rounded-2xl border border-red-500/30">
                        <div class="text-center mb-8">
                            <div class="w-16 h-16 bg-red-900/50 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500">
                                <i class="fas fa-lock text-red-400 text-2xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-white font-tech tracking-wider">SECURE ACCESS</h2>
                            <p class="text-gray-400 text-sm mt-2">Masuk untuk melihat data keuangan</p>
                        </div>

                        <form onsubmit="handleFinanceLogin(event)" class="space-y-6">
                            <div>
                                <label class="block text-gray-400 text-xs uppercase tracking-wider mb-2">Username</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-user text-gray-500"></i>
                                    </div>
                                    <input type="text" id="finance-user" class="w-full bg-black/50 border border-gray-700 rounded-lg py-3 pl-10 pr-4 text-white placeholder-gray-600 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all" placeholder="Enter username">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-400 text-xs uppercase tracking-wider mb-2">Password</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-key text-gray-500"></i>
                                    </div>
                                    <input type="password" id="finance-pass" class="w-full bg-black/50 border border-gray-700 rounded-lg py-3 pl-10 pr-4 text-white placeholder-gray-600 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all" placeholder="••••••••">
                                </div>
                                <p id="pass-error-msg" class="text-red-500 text-xs mt-2 hidden flex items-center">
                                    <i class="fas fa-exclamation-circle mr-1"></i> Data tidak Valid
                                </p>
                            </div>

                            <button type="submit" class="w-full bg-red-700 hover:bg-red-600 text-white font-bold py-3 rounded-lg transition-all shadow-[0_0_15px_rgba(220,38,38,0.4)]">
                                LOGIN
                            </button>
                        </form>
                    </div>
                </div>

                <!-- DASHBOARD CONTAINER (Hidden by default) -->
                <div id="finance-dashboard" class="hidden w-full max-w-4xl px-4 flex flex-col items-center">
                    <div class="text-center mb-10 w-full">
                        <h2 class="text-3xl md:text-5xl font-tech font-bold text-white mb-2">KEUANGAN KELAS</h2>
                        <div class="h-1 w-20 bg-red-600 mx-auto rounded-full"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 w-full">
                        <!-- Total Saldo Card -->
                        <div class="glass-panel p-8 rounded-2xl border border-red-500/30 relative overflow-hidden group">
                            <div class="absolute -right-6 -top-6 w-32 h-32 bg-red-600 rounded-full opacity-10 blur-xl group-hover:opacity-20 transition-all"></div>
                            <div class="relative z-10">
                                <p class="text-gray-400 text-sm uppercase tracking-widest mb-2">Total Saldo Kas</p>
                                <h3 class="text-4xl md:text-5xl font-bold text-white mb-4 font-mono">Rp 600.000</h3>
                                <div class="flex items-center text-green-400 text-sm">
                                    <i class="fas fa-arrow-up mr-1"></i>
                                    <span>+Rp100.000</span>
                                </div>
                            </div>
                        </div>

                        <!-- Info Card -->
                        <div class="glass-panel p-8 rounded-2xl border border-gray-700/50 relative overflow-hidden">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 rounded-lg bg-blue-900/30 flex items-center justify-center text-blue-400 border border-blue-500/30">
                                    <i class="fas fa-info-circle text-xl"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-bold text-lg mb-2">Info Bendahara</h4>
                                    <p class="text-gray-400 text-sm leading-relaxed">
                                        Pembayaran kas bulan ini harap segera dilunasi sebelum berganti bulan berikutnya. Supaya tidak menumpuk dikemudian hari terimakasih atas pengertiannya.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RIWAYAT PENGELUARAN SECTION -->
                    <div class="w-full mb-8">
                        <button onclick="toggleExpenseHistory()" class="flex items-center justify-between w-full bg-gray-900/80 p-4 rounded-xl border border-gray-700 hover:border-red-500 transition-all group shadow-lg z-20 relative">
                            <span class="font-bold text-white flex items-center gap-2">
                                <i class="fas fa-history text-red-500"></i> Riwayat Pengeluaran
                            </span>
                            <i id="history-arrow" class="fas fa-chevron-down text-gray-400 group-hover:text-white transition-transform duration-300"></i>
                        </button>
                        
                        <div id="expense-history-list" class="max-h-0 opacity-0 overflow-hidden transition-all duration-500 ease-in-out">
                            <div class="pt-4 space-y-3">
                                <!-- Contoh Item 1 -->
                                <div class="glass-panel p-4 rounded-lg border border-red-500/20 flex flex-row justify-between items-center gap-4">
                                    <div class="flex items-center gap-4">
                                        <div class="bg-red-900/30 px-3 py-2 rounded-lg text-red-400 text-xs font-mono text-center min-w-[60px] border border-red-500/30">
                                            <div class="font-bold text-lg leading-none">27</div>
                                            <div class="text-[10px]">DES</div>
                                            <div class="text-[10px]">2025</div>
                                        </div>
                                        <div>
                                            <h4 class="text-white font-bold text-sm md:text-base">Spidol & Penghapus</h4>
                                            <p class="text-gray-500 text-xs flex items-center gap-1"><i class="far fa-calendar-alt text-[10px]"></i> Sabtu</p>
                                        </div>
                                    </div>
                                    <div class="text-red-400 font-mono font-bold text-sm md:text-lg whitespace-nowrap">
                                        - Rp 45.000
                                    </div>
                                </div>

                                <!-- Contoh Item 2 (Placeholder) -->
                                <div class="glass-panel p-4 rounded-lg border border-red-500/20 flex flex-row justify-between items-center gap-4 opacity-50">
                                    <div class="flex items-center gap-4">
                                        <div class="bg-gray-800 px-3 py-2 rounded-lg text-gray-500 text-xs font-mono text-center min-w-[60px] border border-gray-700">
                                            <div class="font-bold text-lg leading-none">--</div>
                                            <div class="text-[10px]">BLN</div>
                                            <div class="text-[10px]">THN</div>
                                        </div>
                                        <div>
                                            <h4 class="text-gray-400 font-bold text-sm md:text-base">Belum ada data</h4>
                                            <p class="text-gray-600 text-xs">--</p>
                                        </div>
                                    </div>
                                    <div class="text-gray-500 font-mono font-bold text-sm md:text-lg whitespace-nowrap">
                                        - Rp 0
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="logoutFinance()" class="mx-auto block text-red-400 hover:text-white text-sm transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i> Keluar dari sesi keuangan
                    </button>
                </div>

            </section>

        </main>

        <footer class="border-t border-red-900/30 bg-black/90 mt-12 pt-12 pb-8">
            <!-- Footer unchanged -->
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-8 border-b border-red-900/30 pb-8">
                    <div class="text-left">
                         <h3 class="font-tech text-xl text-white font-bold mb-4 border-b-2 border-red-600 inline-block pb-1">FAKULTAS TARBIYAH</h3>
                         <p class="text-gray-400 text-sm leading-relaxed mt-2">
                             Mencetak pendidik yang berakhlak mulia, berwawasan luas, dan kompeten dalam menjawab tantangan zaman.
                         </p>
                    </div>
                    <div class="text-left">
                        <h3 class="font-tech text-xl text-white font-bold mb-4 border-b-2 border-red-600 inline-block pb-1">KONTAK KAMI</h3>
                        <div class="mt-2 flex flex-col gap-2">
                            <a href="https://maps.app.goo.gl/tfdwTJTneTn89ey36" target="_blank" class="text-gray-400 text-sm flex items-center hover:text-white transition-colors group">
                                <i class="fas fa-map-marker-alt text-red-500 w-6 text-center mr-2 group-hover:scale-110 transition-transform"></i> 
                                Jl. Tentara Pelajar No. 55B
                            </a>
                            <a href="https://wa.me/6281216024273" target="_blank" class="text-gray-400 text-sm flex items-center hover:text-white transition-colors group">
                                <i class="fas fa-phone text-red-500 w-6 text-center mr-2 group-hover:scale-110 transition-transform"></i> 
                                0812-1602-4273
                            </a>
                            <a href="https://twitter.com/iainu_kebumen" target="_blank" class="text-gray-400 text-sm flex items-center hover:text-white transition-colors group">
                                <i class="fab fa-twitter text-red-500 w-6 text-center mr-2 group-hover:scale-110 transition-transform"></i> 
                                @iainu_kebumen
                            </a>
                        </div>
                    </div>
                    <div class="text-left">
                        <h3 class="font-tech text-xl text-white font-bold mb-4 border-b-2 border-red-600 inline-block pb-1">AKADEMIK</h3>
                        <div class="mt-2">
                            <p class="text-gray-400 text-sm mb-2"><i class="fas fa-graduation-cap text-red-500 mr-2"></i> Pendidikan Agama Islam</p>
                            <p class="text-gray-400 text-sm mb-2"><i class="fas fa-calendar-alt text-red-500 mr-2"></i> Angkatan 2025</p>
                            <p class="text-gray-400 text-sm"><i class="fas fa-users text-red-500 mr-2"></i> Kelas B</p>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <p class="font-tech text-gray-500 text-sm text-center md:text-left">© 2025 PAI B - IAINU KEBUMEN. All Rights Reserved.</p>
                    <div class="flex gap-4">
                        <a href="https://www.instagram.com/iainukebumen/" target="_blank" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-gray-400 hover:bg-red-600 hover:text-white transition-all duration-300">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://iainu-kebumen.ac.id/?utm_source=ig&utm_medium=social&utm_content=link_in_bio&fbclid=PAZXh0bgNhZW0CMTEAc3J0YwZhcHBfaWQMMjU2MjgxMDQwNTU4AAGnQrL_efXSleeESFYk2QKkN6BzFcbkVuHqkuvpD0AKrYYmzGs-kkm7mzH8qUk_aem_h2VNO5wVlciA0OHIwGrFxg" target="_blank" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-gray-400 hover:bg-blue-500 hover:text-white transition-all duration-300">
                            <i class="fas fa-globe"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modals (Family Gallery, All Files, Bio, Media, Team Executor) -->
    
    <!-- AUTH FAILED MODAL -->
    <div id="auth-error-modal" class="custom-modal" style="z-index: 9999;">
        <div class="bg-black/90 border border-red-600 rounded-xl p-8 max-w-sm w-full mx-4 text-center transform scale-100 shadow-[0_0_50px_rgba(220,38,38,0.5)]">
            <div class="mb-4 flex justify-center">
                <!-- X Icon Animation -->
                <svg class="w-20 h-20 text-red-600 animate-cross" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </div>
            <h3 class="text-2xl font-bold text-white mb-2 font-tech">AUTHORIZATION FAILED</h3>
            <p class="text-gray-400 text-sm mb-6">Silahkan masukan data yang valid untuk melanjutkan.</p>
            <button onclick="closeAuthError()" class="bg-red-700 hover:bg-red-600 text-white px-6 py-2 rounded-lg text-sm font-bold transition-colors w-full">
                COBA LAGI
            </button>
        </div>
    </div>

    <!-- TEAM EXECUTOR MODAL -->
    <div id="team-executor-modal" class="fullscreen-overlay" tabindex="0">
        <div class="w-full min-h-screen pt-20 pb-10 px-4 relative">
             <button onclick="toggleTeamExecutor()" class="fixed top-6 right-6 z-50 bg-red-600 text-white w-12 h-12 rounded-full hover:bg-red-500 transition flex items-center justify-center text-xl shadow-lg border-2 border-black">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="text-center mb-8 sticky left-0 right-0">
                <h2 class="text-3xl md:text-5xl font-tech font-bold text-white mb-2">TEAM EXECUTOR</h2>
                <p class="text-red-400 text-sm tracking-widest">DIVISI & PELAKSANA</p>
            </div>

            <!-- Executor Content Container -->
            <!-- ADDED: overflow-auto here allows panning around the tree -->
            <div class="w-full overflow-y-auto overflow-x-auto pb-12">
                 <!-- ADDED: min-w-max forces the container to be as wide as the tree requires -->
                 <div id="executor-tree-container" class="tree">
                    <!-- Tree injected via JS -->
                 </div>
            </div>
        </div>
    </div>

    <div id="family-gallery" class="fullscreen-overlay" tabindex="0">
        <!-- Family Gallery Content unchanged -->
        <div class="max-w-7xl mx-auto px-4 pt-24 pb-10 relative">
            <button onclick="toggleFamilyGallery()" class="fixed top-6 right-6 z-50 bg-red-600 text-white w-12 h-12 rounded-full hover:bg-red-500 transition flex items-center justify-center text-xl shadow-lg border-2 border-black">
                <i class="fas fa-times"></i>
            </button>
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-6xl font-tech font-bold text-white mb-2">KELUARGA PAI B</h2>
                <p class="text-red-400 text-lg">Selalu di Hati</p>
            </div>
            <div id="student-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
        </div>
    </div>

    <div id="all-files-overlay" class="fullscreen-overlay" tabindex="0">
         <!-- All Files Content unchanged -->
        <div class="max-w-7xl mx-auto px-4 pt-24 pb-10 relative">
            <button onclick="closeAllFiles()" class="fixed top-6 right-6 z-50 bg-red-600 text-white w-12 h-12 rounded-full hover:bg-red-500 transition flex items-center justify-center text-xl shadow-lg border-2 border-black">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-tech font-bold text-white mb-2">ALL UPLOADED FILES</h2>
                <p class="text-gray-400 text-sm">Memories Activities PAI B 2025</p>
            </div>

            <div id="all-files-grid" class="columns-2 md:columns-3 lg:columns-4 gap-4 space-y-4">
            </div>
        </div>
    </div>

    <!-- Bio Modal & Media Modal unchanged -->
    <div id="bio-modal" class="custom-modal" onclick="closeBioModal(event)">
        <div id="bio-content" class="glass-panel w-[90%] md:w-full max-w-6xl max-h-[90vh] md:max-h-[85vh] overflow-y-auto transform scale-95 transition-all duration-300 rounded-2xl flex flex-col md:flex-row bg-black/90 border border-red-500/30 shadow-2xl relative overflow-hidden" tabindex="0">
            <div class="w-full md:w-5/12 aspect-[9/16] relative bg-gray-900 group shrink-0">
                <div id="modal-img-loader" class="img-loading-skeleton">
                    <i class="fas fa-spinner fa-spin text-red-900 text-4xl"></i>
                </div>
                <img id="modal-img" src="" alt="Profile Photo" class="relative z-10 w-full h-full object-cover transition-opacity duration-500 opacity-0" onerror="this.src='https://placehold.co/400x500?text=No+Image';">
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent md:bg-gradient-to-r md:from-transparent md:to-black/90 z-20 pointer-events-none"></div>
                <button onclick="closeBioModal(null, true)" class="md:hidden absolute top-4 right-4 z-50 bg-black/50 text-white w-8 h-8 rounded-full flex items-center justify-center backdrop-blur-sm border border-white/20">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="w-full md:w-7/12 p-6 md:p-10 flex flex-col justify-center text-left relative bg-black/50 md:bg-transparent">
                <div class="absolute top-0 right-0 p-6 opacity-10 hidden md:block">
                    <i class="fas fa-fingerprint text-9xl text-red-600"></i>
                </div>
                <div class="mb-6 md:mb-10 relative z-10">
                    <h2 id="modal-name" class="text-2xl md:text-6xl font-bold text-white font-tech mb-2 tracking-wide leading-tight drop-shadow-lg">Name Here</h2>
                    <div class="flex items-center gap-3">
                        <span class="px-4 py-1 bg-red-900/40 border border-red-500/30 rounded text-red-400 font-mono text-xs md:text-base tracking-wider" id="modal-nim">NIM: 00000000</span>
                    </div>
                </div>
                <div class="space-y-6 relative z-10">
                    <div class="bio-info-row group">
                        <div class="bio-icon-box w-10 h-10 md:w-14 md:h-14 text-lg md:text-2xl">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <div class="flex-grow pt-1 md:pt-2">
                            <span class="text-[10px] md:text-xs text-gray-500 uppercase tracking-[0.2em] font-bold block mb-1">Instagram</span>
                            <div id="modal-ig" class="text-sm md:text-xl"></div>
                        </div>
                    </div>
                    <div class="bio-info-row group">
                        <div class="bio-icon-box w-10 h-10 md:w-14 md:h-14 text-lg md:text-2xl">
                            <i class="fas fa-quote-left"></i>
                        </div>
                        <div class="flex-grow pt-1 md:pt-2">
                            <span class="text-[10px] md:text-xs text-gray-500 uppercase tracking-[0.2em] font-bold block mb-1">About Me</span>
                            <p id="modal-bio" class="text-gray-300 font-light leading-relaxed text-sm md:text-xl italic pr-2 md:pr-8 text-justify">"..."</p>
                        </div>
                    </div>
                </div>
                 <button onclick="closeBioModal(null, true)" class="hidden md:flex absolute top-6 right-6 z-50 bg-transparent text-white/50 hover:text-white transition w-10 h-10 items-center justify-center text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="media-modal" class="custom-modal" onclick="closeMediaModal(event)">
        <div class="relative max-w-5xl w-full mx-4 flex justify-center">
            <button onclick="closeMediaModal(null, true)" class="absolute -top-12 right-0 md:-right-12 text-white hover:text-red-500 text-3xl transition z-50">
                <i class="fas fa-times"></i>
            </button>
            <div id="media-container" class="max-h-[85vh] rounded-lg shadow-2xl border border-red-500/30">
            </div>
        </div>
    </div>

    <script>
        // Existing Scripts
        const textToType = "PAI B";
        const typingElement = document.getElementById('typing-text');
        let i = 0;

        function typeWriter() {
            if (i < textToType.length) {
                typingElement.innerHTML += textToType.charAt(i);
                i++;
                setTimeout(typeWriter, 150);
            }
        }

        window.onload = function() {
            typeWriter();
            generateStudents(); 
            initDocumentation(); 
            
            // --- FIX: Initialize Buttons & Semester ---
            // Ensure first semester is shown and button states are correct on load
            updateSemesterDisplay(); // This will handle visibility of arrows and content
            
            if (!history.state) {
                history.replaceState({ page: 'home' }, '', '#home');
            }
            
            // SECURITY: Disable keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Prevent F12
                if (e.key === 'F12') { e.preventDefault(); return false; }
                // Prevent Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
                if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) { e.preventDefault(); return false; }
                // Prevent Ctrl+U (View Source)
                if (e.ctrlKey && e.key === 'u') { e.preventDefault(); return false; }
                // Prevent Ctrl+S (Save Page)
                if (e.ctrlKey && e.key === 's') { e.preventDefault(); return false; }
            });

            // SECURITY: Simple debugger trap
            setInterval(() => {
                const start = new Date().getTime();
                debugger;
                const end = new Date().getTime();
            }, 1000);
            
            // Close mobile menu on outside click
            document.addEventListener('click', (e) => {
                const menu = document.getElementById('mobile-menu');
                const btn = document.getElementById('mobile-menu-btn');
                
                // If menu is open (check for max-h-screen class)
                if (menu && menu.classList.contains('max-h-screen')) {
                    // If click target is NOT inside the menu AND NOT the button itself
                    if (!menu.contains(e.target) && !btn.contains(e.target)) {
                        toggleMobileMenu(); // Use function to animate close
                    }
                }
            });
        };

        // Standard Functions (enterSite, toggleMusic, switchTab, toggleMobileMenu) unchanged
        function enterSite() {
            const intro = document.getElementById('intro-screen');
            const mainApp = document.getElementById('main-app');
            const audio = document.getElementById('bg-music');
            if (audio) {
                audio.play().catch(error => { console.log("Audio autoplay blocked:", error); });
            }
            intro.style.transform = 'translateY(-100%)';
            intro.style.opacity = '0';
            mainApp.classList.remove('hidden');
            setTimeout(() => {
                mainApp.style.opacity = '1';
                setTimeout(() => { intro.style.display = 'none'; }, 800);
            }, 100);
        }

        let isPlaying = true;
        function toggleMusic() {
            const audio = document.getElementById('bg-music');
            const btn = document.getElementById('music-btn');
            if (isPlaying) {
                audio.pause();
                btn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                btn.classList.remove('music-pulse');
                isPlaying = false;
            } else {
                audio.play();
                btn.innerHTML = '<i class="fas fa-music"></i>';
                btn.classList.add('music-pulse');
                isPlaying = true;
            }
        }

        document.addEventListener('visibilitychange', function() {
            const audio = document.getElementById('bg-music');
            if (document.hidden) {
                audio.pause();
            } else {
                if(isPlaying) {
                    audio.play().catch(e => console.log("Resume prevented", e));
                }
            }
        });

        function switchTab(tabId) {
            // 1. Show Loader
            const loader = document.getElementById('page-loader');
            loader.classList.remove('opacity-0', 'pointer-events-none');
            loader.classList.add('active'); 

            // 2. Wait for visual effect
            setTimeout(() => {
                // 3. Switch UI (The existing logic)
                _switchTabUI(tabId);
                
                // 4. Scroll to top
                window.scrollTo(0, 0);
                
                // 5. Update History
                history.pushState({ page: tabId }, '', '#' + tabId);
                
                // 6. Hide Loader after a slight delay
                setTimeout(() => {
                    loader.classList.remove('active');
                    loader.classList.add('opacity-0', 'pointer-events-none');
                }, 300);
                
            }, 500); 
        }

        function _switchTabUI(tabId) {
            const sections = document.querySelectorAll('main section');
            sections.forEach(section => {
                section.classList.remove('active-section');
                section.classList.add('hidden-section');
                section.style.display = 'none'; 
            });

            const target = document.getElementById(tabId);
            if (target) {
                if (tabId === 'finance') {
                    target.style.display = 'flex';
                } else {
                    target.style.display = 'block';
                }
                
                requestAnimationFrame(() => {
                    target.classList.remove('hidden-section');
                    target.classList.add('active-section');
                });
            }
            
            // Close mobile menu if open
            const menu = document.getElementById('mobile-menu');
             if (menu.classList.contains('max-h-screen')) {
                toggleMobileMenu();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            if (menu.classList.contains('max-h-0')) {
                // Open
                menu.classList.remove('max-h-0', 'opacity-0');
                menu.classList.add('max-h-screen', 'opacity-100');
            } else {
                // Close
                menu.classList.remove('max-h-screen', 'opacity-100');
                menu.classList.add('max-h-0', 'opacity-0');
            }
        }

        /* --- FINANCE LOGIC --- */
        function handleFinanceLogin(e) {
            e.preventDefault();
            const user = document.getElementById('finance-user').value;
            const pass = document.getElementById('finance-pass');
            const passVal = pass.value;
            const errorMsg = document.getElementById('pass-error-msg');

            // Hardcoded Credentials
            if (user === 'Tarbiyah' && passVal === 'paib.2025') {
                // Success
                document.getElementById('finance-login').classList.add('hidden');
                document.getElementById('finance-dashboard').classList.remove('hidden');
                errorMsg.classList.add('hidden');
            } else {
                // Fail
                pass.value = ''; // Clear password
                errorMsg.classList.remove('hidden'); // Show inline error
                
                // Show Popup
                const modal = document.getElementById('auth-error-modal');
                modal.classList.add('active');
            }
        }

        function closeAuthError() {
            document.getElementById('auth-error-modal').classList.remove('active');
        }

        function logoutFinance() {
            document.getElementById('finance-user').value = '';
            document.getElementById('finance-pass').value = '';
            document.getElementById('finance-dashboard').classList.add('hidden');
            document.getElementById('finance-login').classList.remove('hidden');
            document.getElementById('pass-error-msg').classList.add('hidden');
        }

        /* --- EXPENSE HISTORY TOGGLE --- */
        function toggleExpenseHistory() {
            const list = document.getElementById('expense-history-list');
            const arrow = document.getElementById('history-arrow');
            
            // Check if open by checking max-height class
            if (list.classList.contains('max-h-0')) {
                // Open
                list.classList.remove('max-h-0', 'opacity-0');
                list.classList.add('max-h-[1000px]', 'opacity-100'); // Arbitrary large height
                arrow.style.transform = 'rotate(180deg)';
            } else {
                // Close
                list.classList.remove('max-h-[1000px]', 'opacity-100');
                list.classList.add('max-h-0', 'opacity-0');
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        /* --- SEMESTER & STRUCTURE LOGIC --- */

        const semesterList = ["I", "II", "III", "IV", "V", "VI", "VII", "VIII"];
        let currentSemesterIndex = 0; // Starts at I

        // Helper to generate structure cards HTML
        function createCard(img, name, role) {
            return `
             <div class="glass-panel text-center p-2 md:p-4 rounded-xl border border-red-500/30 inline-block w-28 md:w-48 hover:bg-red-900/40 transition-colors z-10 relative mx-1 mb-2 md:mx-2 md:mb-4">
                <div class="w-12 h-12 md:w-16 md:h-16 mx-auto bg-gray-700 rounded-full mb-2 overflow-hidden border-2 border-red-500">
                    <img src="${img}" alt="${role}" class="w-full h-full object-cover"
                         onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=random';">
                </div>
                <h3 class="font-bold text-white text-[10px] md:text-sm break-words">${name}</h3>
                <p class="text-[8px] md:text-[10px] text-gray-400 uppercase tracking-wider">${role}</p>
            </div>`;
        }
        
        // --- DATA STRUKTUR PER SEMESTER ---
        const structureData = {
            "I": {
                ketua: { name: "Ubaidillah M.", img: "Ubaidillah.jpg" },
                wakil: { name: "Pniel Munandar", img: "Pniel.jpg" },
                sek1: { name: "Riska Ayu K.", img: "Ayu.jpg" },
                sek2: { name: "Yoana Dian R.A.", img: "Yoana.jpg" },
                ben1: { name: "Putri Dwi Astuti", img: "Putri.jpg" },
                ben2: { name: "Anggun Lolyka H.", img: "Anggun.jpg" }
            },
            "II": {
                // Isi data semester II di sini nanti
                ketua: { name: "Belum Ditentukan", img: "" },
                wakil: { name: "Belum Ditentukan", img: "" },
                koor: { name: "Belum Ditentukan", img: "" },
                sek1: { name: "Belum Ditentukan", img: "" },
                sek2: { name: "Belum Ditentukan", img: "" },
                ben1: { name: "Belum Ditentukan", img: "" }
            },
            // Tambahkan objek untuk "III", "IV"
        };

        function getStructData(sem) {
            // Jika data spesifik semester ada di structureData, pakai itu.
            // Jika tidak, pakai placeholder default.
            if (structureData[sem]) {
                // Merge dengan default agar tidak error jika ada field yang kurang
                return { 
                    ketua: { name: "Belum Ditentukan", img: "" },
                    wakil: { name: "Belum Ditentukan", img: "" },
                    koor: { name: "Belum Ditentukan", img: "" },
                    sek1: { name: "Belum Ditentukan", img: "" },
                    sek2: { name: "Belum Ditentukan", img: "" },
                    ben1: { name: "Belum Ditentukan", img: "" },
                    ...structureData[sem] 
                };
            }
            
            return {
                ketua: { name: "Belum Ditentukan", img: "" },
                wakil: { name: "Belum Ditentukan", img: "" },
                koor: { name: "Belum Ditentukan", img: "" },
                sek1: { name: "Belum Ditentukan", img: "" },
                sek2: { name: "Belum Ditentukan", img: "" },
                ben1: { name: "Belum Ditentukan", img: "" },
                ben2: { name: "Belum Ditentukan", img: "" }
            };
        }

        function updateSemesterDisplay() {
            const sem = semesterList[currentSemesterIndex];
            const displayEl = document.getElementById('current-semester-display');
            const prevBtn = document.getElementById('btn-prev-sem');
            const nextBtn = document.getElementById('btn-next-sem');

            // Logic Visibility Anak Panah
            if (currentSemesterIndex === 0) {
                prevBtn.style.visibility = 'hidden';
            } else {
                prevBtn.style.visibility = 'visible';
            }

            if (currentSemesterIndex === semesterList.length - 1) {
                nextBtn.style.visibility = 'hidden';
            } else {
                nextBtn.style.visibility = 'visible';
            }
            
            // Logic Team Executor Button
            const teamExecutorBtn = document.getElementById('btn-team-executor');
            if (currentSemesterIndex === 0) { // Semester I
                if(teamExecutorBtn) teamExecutorBtn.style.display = 'none';
            } else {
                if(teamExecutorBtn) teamExecutorBtn.style.display = 'block'; // Or inline-flex if needed, but the parent aligns it.
            }
            
            // Animation effect for text change
            displayEl.style.opacity = '0';
            setTimeout(() => {
                displayEl.innerText = `SEMESTER ${sem}`;
                displayEl.style.opacity = '1';
            }, 200);
            
            changeSemester(sem);
        }

        function nextSemester() {
            if (currentSemesterIndex < semesterList.length - 1) {
                currentSemesterIndex++;
                updateSemesterDisplay();
            }
        }

        function prevSemester() {
            if (currentSemesterIndex > 0) {
                currentSemesterIndex--;
                updateSemesterDisplay();
            }
        }

        function changeSemester(sem) {
            const loader = document.getElementById('structure-loading-overlay');
            const loaderText = document.getElementById('structure-loader-text');
            const container = document.getElementById('structure-content-container');

            loaderText.innerText = `Beralih Semester ${sem}...`;
            loader.classList.add('active');
            container.style.opacity = '0'; // Completely hide content

            setTimeout(() => {
                updateStructureUI(sem);
                loader.classList.remove('active');
                container.style.opacity = '1';
            }, 800);
        }

        function updateStructureUI(sem) {
            const container = document.getElementById('structure-content-container');
            const data = getStructData(sem);
            let html = '';

            // Layout for Semester I (Tree Only)
            if (sem === "I") {
                const treeHtml = `
                    <div class="tree">
                        <ul>
                            <li>
                                ${createCard(data.ketua.img, data.ketua.name, "Ketua Kelas")}
                                <ul>
                                    <li>
                                        ${createCard(data.wakil.img, data.wakil.name, "Wakil Ketua")}
                                        <ul>
                                            <!-- Sekretaris Group -->
                                            <li>
                                                <div class="flex flex-col gap-4 items-center pt-4">
                                                    ${createCard(data.sek1.img, data.sek1.name, "Sekretaris 1")}
                                                    ${createCard(data.sek2.img, data.sek2.name, "Sekretaris 2")}
                                                </div>
                                            </li>
                                            <!-- Bendahara Group -->
                                            <li>
                                                <div class="flex flex-col gap-4 items-center pt-4">
                                                    ${createCard(data.ben1.img, data.ben1.name, "Bendahara 1")}
                                                    ${createCard(data.ben2.img, data.ben2.name, "Bendahara 2")}
                                                </div>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>`;
                html = treeHtml;

            } else {
                // Layout for Semester II+ (Tree Only)
                const treeHtml = `
                    <div class="tree">
                        <ul>
                            <li>
                                ${createCard(data.ketua.img, data.ketua.name, "Ketua Kelas")}
                                <ul>
                                    <li>
                                        ${createCard(data.wakil.img, data.wakil.name, "Wakil Ketua")}
                                        <ul>
                                            <li>
                                                 ${createCard(data.koor.img, data.koor.name, "Koordinator")}
                                                 <ul>
                                                    <!-- Sekretaris -->
                                                    <li>
                                                        <div class="flex flex-col gap-4 items-center pt-4">
                                                             ${createCard(data.sek1.img, data.sek1.name, "Sekretaris 1")}
                                                             ${createCard(data.sek2.img, data.sek2.name, "Sekretaris 2")}
                                                        </div>
                                                    </li>
                                                    <!-- Bendahara -->
                                                    <li>
                                                        <div class="flex flex-col gap-4 items-center pt-4">
                                                             ${createCard(data.ben1.img, data.ben1.name, "Bendahara")}
                                                        </div>
                                                    </li>
                                                 </ul>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>`;
                html = treeHtml;
            }

            container.innerHTML = html;
        }

        /* --- TEAM EXECUTOR LOGIC --- */
        
        function toggleTeamExecutor() {
            const modal = document.getElementById('team-executor-modal');
            const container = document.getElementById('executor-tree-container');
            
            if (modal.classList.contains('open')) {
                if (history.state && history.state.page === 'team-executor') {
                    history.back();
                    return;
                }
                modal.classList.remove('open');
                document.body.style.overflow = 'auto';
            } else {
                renderTeamExecutorTree(container);
                modal.classList.add('open');
                document.body.style.overflow = 'hidden';
                history.pushState({ page: 'team-executor' }, '', '#team-executor');
                modal.focus();
            }
        }

        function renderTeamExecutorTree(container) {
            // Placeholder Data for Executor
            const data = {
                ketua: { name: "Nama Ketua", img: "" },
                wakil: { name: "Nama Wakil", img: "" },
                koor: { name: "Nama Koordinator", img: "" },
                sek1: { name: "Nama Sekretaris 1", img: "" }, 
                sek2: { name: "Nama Sekretaris 2", img: "" }, 
                ben: { name: "Nama Bendahara", img: "" },
                div_kebersihan: Array(6).fill({name: "Anggota", img: ""}),
                div_kreatif: Array(3).fill({name: "Anggota", img: ""}),
                div_sosial: Array(3).fill({name: "Anggota", img: ""})
            };

            // FIX: Struktur UL/LI agar garis (tree lines) terhubung ke Divisi juga
            const html = `
            <ul>
                <li>
                    ${createCard(data.ketua.img, data.ketua.name, "Ketua Pelaksana")}
                    <ul>
                        <li>
                            ${createCard(data.wakil.img, data.wakil.name, "Wakil Ketua")}
                            <ul>
                                <li>
                                    ${createCard(data.koor.img, data.koor.name, "Koordinator")}
                                    <ul>
                                        <!-- Cabang 1: Sekretaris (Stacked) -->
                                        <li>
                                            <div class="flex flex-col gap-4 items-center pt-4">
                                                ${createCard(data.sek1.img, data.sek1.name, "Sekretaris 1")}
                                                ${createCard(data.sek2.img, data.sek2.name, "Sekretaris 2")}
                                            </div>
                                        </li>
                                        
                                        <!-- Cabang 2: Bendahara (Sendiri, jadi ukurannya normal) -->
                                        <li>
                                            <div class="flex flex-col gap-4 items-center pt-4">
                                                ${createCard(data.ben.img, data.ben.name, "Bendahara")}
                                            </div>
                                        </li>

                                        <!-- Cabang 3: DIVISI (Sebagai Node Tree) -->
                                        <li>
                                            <div class="glass-panel px-4 py-2 mt-4 rounded-full border border-red-500 text-white font-bold text-xs tracking-widest inline-block">DIVISI</div>
                                            <ul>
                                                <!-- Tim Kebersihan -->
                                                <li>
                                                    <div class="glass-panel p-2 rounded-lg border border-red-500/50 mb-2 inline-block">
                                                        <h5 class="text-red-400 font-bold text-[10px] md:text-xs whitespace-nowrap">TIM KEBERSIHAN</h5>
                                                    </div>
                                                    <div class="flex justify-center">
                                                        <div class="grid grid-cols-1 gap-2">
                                                            ${data.div_kebersihan.map((m, i) => createCard(m.img, m.name, `Anggota ${i+1}`)).join('')}
                                                        </div>
                                                    </div>
                                                </li>

                                                <!-- Tim Kreatif -->
                                                <li>
                                                    <div class="glass-panel p-2 rounded-lg border border-orange-500/50 mb-2 inline-block">
                                                        <h5 class="text-orange-400 font-bold text-[10px] md:text-xs whitespace-nowrap">TIM KREATIF</h5>
                                                    </div>
                                                    <div class="flex justify-center">
                                                        <div class="flex flex-col gap-2">
                                                            ${data.div_kreatif.map((m, i) => createCard(m.img, m.name, `Anggota ${i+1}`)).join('')}
                                                        </div>
                                                    </div>
                                                </li>

                                                <!-- Tim Sosial -->
                                                <li>
                                                    <div class="glass-panel p-2 rounded-lg border border-yellow-500/50 mb-2 inline-block">
                                                        <h5 class="text-yellow-400 font-bold text-[10px] md:text-xs whitespace-nowrap">TIM SOSIAL</h5>
                                                    </div>
                                                    <div class="flex justify-center">
                                                        <div class="flex flex-col gap-2">
                                                            ${data.div_sosial.map((m, i) => createCard(m.img, m.name, `Anggota ${i+1}`)).join('')}
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
            `;
            container.innerHTML = html;
        }

        /* --- STUDENT DATA (Unchanged) --- */
        const studentsData = [
            { name: "Ady Surya", nim: "2511038", ig: "@suryaadharm_", img: "Ady.jpg", bioImg: "Ady-2.jpg", bio: "Saya orang yang menyukai berpetualang dan menikmati keindahan alam untuk menghilangkan kebosanan dan mengagumi ciptaan Tuhan, sungguh indah." },
            { name: "A. Lubadul Fikri", nim: "2511046", ig: "@bangkriii_", img: "Fikri.jpg", bioImg: "Fikri-2.jpg", bio: "Seseorang yang berkepribadian introvert abizzz. Saya ingin melihat dan memahami dunia di luar sana.Saya tak ingin lenyap di dalam bagian beberapa penghalang yang ada ini tanpa mengetahui apa yang ada di luar sana." },
            { name: "Alyvia Qurrotal A.", nim: "2511042 ", ig: "@piaa.ainiii", img: "Alyvia.jpg", bioImg: "Alyvia-2.jpg", bio: "Saya dikenal sebagai pribadi yang ceria, aktif, dan antusias. Saya juga menyukai tentang hal-hal baru yang membuat saya berkembang." },
            { name: "Anggun Lolyka H.", nim: "2511043", ig: "@_nnggunn_", img: "Anggun.jpg", bioImg: "Anggun-2.png", bio: "Saya orang yang kreatif dengan rasa ingin tahu yang tinggi. Saya senang mempelajari hal-hal baru dan bertemu orang-orang dari berbagai latar belakang karena saya percaya setiap orang memiliki keunikan tersendiri untuk dibagikan." },
            { name: "Aqillah Mazaya", nim: "2511043", ig: "@aqilahmz._", img: "Aqila.jpg", bioImg: "Aqila-2.jpg", bio: "Saya memiliki minat di bidang agama dan pendidikan. Saya berharap dapat menjadi pendidik yang amanah dan dapat membawa keberkahan bagi diri saya dan orang-orang di sekitar saya." },
            { name: "Arina Manasika", nim: "2511065", ig: "@mnskaaa_", img: "https://i.ibb.co.com/HfFbTk5d/Arina.jpg", bioImg: "https://i.ibb.co.com/qYcRtzmh/Arina-2.jpg", bio: "Saya berusaha menjadi pribadi yang terus bertumbuh dan berani keluar dari zona nyaman, saya percaya bahwa setiap tantangan yang kita hadapi membentuk karakter dan membuka kesempatan baru untuk belajar." },
            { name: "Devi Kurniasari", nim: "2511052", ig: "@devy____08", img: "https://i.ibb.co.com/jPpbP6mh/Devi.jpg", bioImg: "https://i.ibb.co.com/fzQ7pSBj/Devi-2.jpg", bio: "Saya pantang menyerah untuk meraih masa depan. Ke-depannya, saya ingin menjadi pribadi yang lebih baik." },
            { name: "Elok Iis N.", nim: "2511060", ig: "@dhe.el", img: "https://i.ibb.co.com/b5dB7M6T/Elok.jpg", bioImg: "https://i.ibb.co.com/jvZ535PS/Elok-2.jpg", bio: "Senyum adalah sedekah termudah. Selalu berusaha menyebarkan positif vibes." },
            { name: "Farihatul Azizah", nim: "2511037", ig: "@fariha_aziizah", img: "https://i.ibb.co.com/WvKp3sFy/Azizah.jpg", bioImg: "https://i.ibb.co.com/mC8myQFY/Azizah-2.jpg", bio: "Introvert, Bermimpilah dan raihlah mimpi itu dengan ilmu yang bermanfaat, serta berusaha menjadi pribadi yang lebih baik dari sebelumnya." },
            { name: "Hanan Tsuroya A.", nim: "2511073", ig: "@hanan_akyasi", img: "https://i.ibb.co.com/ZRRX7M4p/Hanan.jpg", bioImg: "https://i.ibb.co.com/JwBMTXd3/Hanan-2.jpg", bio: "Saya sangat menyukai alam. Rumah saya di Kebumen dan saya sangat suka kuliah di IAINU Kebumen. Saya sangat menyukai kucing dan menikmati alam." },
            { name: "Hanni Hasanati", nim: "2511068", ig: "@hannihsnt_", img: "https://i.ibb.co.com/WpRW8nk3/Hanni.jpg", bioImg: "https://i.ibb.co.com/ZpfVnYDx/Hanni-2.jpg", bio: "Saya anak kedua dari tiga bersaudara, dan semua saudara saya laki-laki. Saat ini saya kuliah di IAINU Kebumen, jurusan Pendidikan Agama Islam." },
            { name: "Jembar Juli Y.", nim: "2511049", ig: "@jembarjulyy_", img: "https://i.ibb.co.com/cccBPB93/Juli.jpg", bioImg: "https://i.ibb.co.com/N2tbfsKz/Juli-2.jpg", bio: "Saya orang yang ceria dan periang. Saya suka tersenyum dan membuat orang lain merasa nyaman di sekitar saya. Dengan pandangan saya yang cerah dan optimis, saya selalu melihat sisi baik dari setiap situasi dan berusaha menyebarkan kebahagiaan kepada orangorang di sekitar saya." },
            { name: "Lusi Rahmah O.", nim: "2511080", ig: "@lusioktaviara", img: "https://i.ibb.co.com/LDqfr0GJ/Lusi.jpg", bioImg: "https://i.ibb.co.com/twy2986P/Lusi-2.jpg", bio: "Saya punya banyak impian untuk masa depan, terutama menjadi orang sukses, kaya, dan dermawan, dan masih banyak lagi impian." },
            { name: "M. Hanif Fakhry", nim: "2511079", ig: "@hann_id1028", img: "https://i.ibb.co.com/3ytbB3bs/Fakhry.jpg", bioImg: "https://i.ibb.co.com/JRhVJy8b/Fakhry-2.jpg", bio: "Alhamdulillah saya mampu menguasai perangkat lunak desain seperti Canva, Solidwork, Panzoid, dll. Dan Alhamdulillah Saya juga memahami kebutuhan dan menerjemahkannya ke dalam desain pemodelan yang estetis dan fungsional. Saya berorientasi pada detail, imajinatif, dan selalu merencanakan ke depan." },
            { name: "Pniel Munandar", nim: "2511053", ig: "@pniel76", img: "https://i.ibb.co.com/35y5ZszF/Pniel.jpg", bioImg: "https://i.ibb.co.com/9kkr0JjT/Pniel-2.jpg", bio: "Saya sangat suka bermain musik, terutama drum. Saya juga bekerja sebagai karyawan untuk mendapatkan penghasilan sendiri, tujuannya adalah untuk meringankan beban orang tua saya." },
            { name: "Putri Dwi Astuti", nim: "2511061", ig: "@putridwia12_", img: "https://i.ibb.co.com/xK65ZXBK/Putri.jpg", bioImg: "https://i.ibb.co.com/bMYd4Smn/Putri-2.jpg", bio: "saya suka suasana yang damai dan sejuk karena membuat saya senang prinsip hidup saya adalah selalu berbuat yang terbaik dan cita cita saya ingin menjadi guru dan pengusaha yang sukses." },
            { name: "Riska Ayu K.", nim: "2511039", ig: "@baiza_salma", img: "https://i.ibb.co.com/T6G584W/Ayu.jpg", bioImg: "https://i.ibb.co.com/bMXW2DBs/Ayu-2.jpg", bio: "Saya seorang pemikir, pemilih, dan individu yang sangat ambisius di dunia akademis. Saya bercita-cita menjadi pembicara yang baik dan anggota yang cakap di organisasi mana pun." },
            { name: "Siti Ulfatur R.", nim: "2511077", ig: "@sssittt_____", img: "https://i.ibb.co.com/fVnxMnbM/Ulfa.jpg", bioImg: "https://i.ibb.co.com/qFWXZzNN/Ulfa-2.jpg", bio: "Saya anak pertama dari 3 bersaudara. Menjadi anak pertama memang tidak mudah, apalagi perempuan. Tapi saya selalu berusaha menikmati perjalanan hidup saya." },
            { name: "Tsabita Hasna H.", nim: "2511071", ig: "@tsabitahasna.__", img: "https://i.ibb.co.com/DH2s9tsY/Tsabita.jpg", bioImg: "https://i.ibb.co.com/Y7jz2r8W/Tsabita-2.jpg", bio: "Saya adalah seseorang yang terus belajar dari setiap langkah. Luka menguatkan saya, doa menenangkan saya, dan harapan selalu membuat saya berdiri kembali." },
            { name: "Ubaidillah M.", nim: "2511064", ig: "@muss_tffa", img: "https://i.ibb.co.com/8DTHNmN1/Ubaidillah.jpg", bioImg: "https://i.ibb.co.com/v41TxJYx/Ubay-2.jpg", bio: "Saya ubaid,pribadi yang percaya bahwa selama aku bernapas, selalu ada harapan untuk terus maju. Hidupku adalah perjalanan belajar dan berjuang, di mana setiap tantangan menjadi peluang untuk tumbuh dan menjadi lebih baik.Keinginan ku suatu saat nanti ingin menjadi manusia yang bermanfaat sesama manusia lain." },
            { name: "Yoana Dian R.A.", nim: "2511054", ig: "@yoana.diaan", img: "https://i.ibb.co.com/8g9FF4zH/Yoana.jpg", bioImg: "https://i.ibb.co.com/nM5j9mkn/Yoana-2.png", bio: "Prinsip hidup saya adalah tetap bersyukur, jangan membandingkan diri dengan orang lain, karena setiap manusia punya prosesnya masing-masing. Cita-cita saya ke depannya adalah menjadi perempuan yang kaya ilmu dan mampu mengamalkannya." },
            { name: "Youvischa Aulia A.", nim: "2511057", ig: "@youvischa_sinta", img: "https://i.ibb.co.com/DDBT5PS0/Youvischa.jpg", bioImg: "https://i.ibb.co.com/HTDNyxVD/Youvischa-2.jpg", bio: "Halo, nama saya Vischa. Saya anak tertua dari dua bersaudara. Saat ini saya kuliah di IAINU Kebumen, jurusan Pendidikan Agama Islam." },
            { name: "Yuyun Lutfiyatul K.", nim: "2511051", ig: "@yuyunltfykh_", img: "https://i.ibb.co.com/mrhGkwVg/Yuyun.jpg", bioImg: "https://i.ibb.co.com/cK2mPg4S/Yuyun-2.jpg", bio: "Saya menyukai aktivitas memasak dan berkebun. Pengalaman paling menyenangkan saya adalah saat mendaki gunung." },
            { name: "Zain Nur Fadilah", nim: "2511076", ig: "@Artyzeen08", img: "https://i.ibb.co.com/35LTF95t/Zain.jpg", bioImg: "https://i.ibb.co.com/DTLyKRx/Zain-2.png", bio: "Takdir menempatkan saya sebagai yang tertua di PAI B 2025, tapi itu hanyalah angka di atas kertas. Menjadi tua itu pasti, tapi menjadi dewasa dan berilmu adalah pilihan yang harus diperjuangkan dan saya masih berjuang untuk itu Maka, anggaplah saya teman diskusi yang setara. Mari kita buktikan bahwa PAI B 2025 bukan sekadar kelas kuliah, tapi inkubator persaudaraan dunia akhirat. Sukses kita bukan saat satu orang lari duluan ke garis finis, tapi saat kita semua saling gandeng tangan sampai tujuan." }
        ];

        function generateStudents() {
            const grid = document.getElementById('student-grid');
            let html = '';
            studentsData.forEach((student, index) => {
                const bio = student.bio || "Mahasiswa PAI B 2025."; 
                html += `
                    <div onclick="openBioModal('${index}')" class="group cursor-pointer">
                        <div class="relative overflow-hidden rounded-xl aspect-square border-2 border-transparent group-hover:border-red-500 transition-all duration-300 bg-gray-900">
                            <div class="img-loading-skeleton z-0"><i class="fas fa-spinner fa-spin text-red-900 text-2xl"></i></div>
                            <img src="${student.img}" alt="${student.name}" 
                                 class="relative z-10 w-full h-full object-cover transition-opacity duration-500 opacity-0 group-hover:scale-110"
                                 onload="this.classList.replace('opacity-0', 'opacity-100')"
                                 onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(student.name)}&background=random&size=200'; this.classList.replace('opacity-0', 'opacity-100');">
                            <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80 z-20 pointer-events-none"></div>
                            <div class="absolute bottom-2 left-2 right-2 z-20 pointer-events-none">
                                <p class="text-white font-bold text-sm truncate group-hover:text-red-400 transition-colors">${student.name}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
            grid.innerHTML = html;
        }

        const existingMedia = [
            { type: 'video', src: 'JJ 1.mp4', title: 'JJ', ratio: 'aspect-[9/16]' },
            { type: 'image', src: 'PAI B.jpg', title: 'Logo', ratio: 'aspect-square' },
            { type: 'video', src: 'English Tim.mp4', title: 'English Game', ratio: 'aspect-video' },
            { type: 'image', src: 'Fotbar Sekelas 2.jpg', title: 'Fotbar', ratio: 'aspect-[4/5]' },
            { type: 'video', src: 'WhatsApp Video 2025-11-30 at 10.44.47.mp4', title: 'Clip', ratio: 'aspect-[4/5]' },
            { type: 'image', src: 'Series PAI B.jpg', title: 'PAI B SERIES', ratio: 'aspect-video' },
            { type: 'video', src: 'WhatsApp Video 2025-11-30 at 10.44.47.mp4', title: 'Vlog', ratio: 'aspect-square' },
            { type: 'image', src: 'Fotbar Sekelas.jpg', title: 'Fotbar', ratio: 'aspect-[9/16]' }
        ];

        const allFilesData = [
            ...existingMedia,
            { type: 'image', src: 'https://placehold.co/600x800/1a0505/FFF?text=FOTO+9', title: '-', ratio: 'aspect-[3/4]' },
            { type: 'video', src: 'JJ 1.mp4', title: 'Video 10', ratio: 'aspect-[9/16]' },
            { type: 'image', src: 'https://placehold.co/800x600/1a0505/FFF?text=FOTO+11', title: '-', ratio: 'aspect-video' },
            { type: 'image', src: 'https://placehold.co/600x600/1a0505/FFF?text=FOTO+12', title: '-', ratio: 'aspect-square' },
            { type: 'video', src: 'JJ 1.mp4', title: 'Video 13', ratio: 'aspect-[4/5]' },
            { type: 'image', src: 'https://placehold.co/600x900/1a0505/FFF?text=FOTO+14', title: '-', ratio: 'aspect-[9/16]' },
            { type: 'image', src: 'https://placehold.co/800x600/1a0505/FFF?text=FOTO+15', title: '-', ratio: 'aspect-video' },
            { type: 'video', src: 'JJ 1.mp4', title: 'Video 16', ratio: 'aspect-square' },
            { type: 'image', src: 'https://placehold.co/600x800/1a0505/FFF?text=FOTO+17', title: '-', ratio: 'aspect-[3/4]' },
            { type: 'image', src: 'https://placehold.co/600x600/1a0505/FFF?text=FOTO+18', title: '-', ratio: 'aspect-square' },
            { type: 'video', src: 'JJ 1.mp4', title: 'Video 19', ratio: 'aspect-[9/16]' },
            { type: 'image', src: 'https://placehold.co/800x600/1a0505/FFF?text=FOTO+20', title: '-', ratio: 'aspect-video' },
            { type: 'image', src: 'https://placehold.co/600x800/1a0505/FFF?text=FOTO+21', title: '-', ratio: 'aspect-[4/5]' },
            { type: 'video', src: 'JJ 1.mp4', title: 'Video 22', ratio: 'aspect-square' },
            { type: 'image', src: 'https://placehold.co/600x900/1a0505/FFF?text=FOTO+23', title: '-', ratio: 'aspect-[9/16]' },
            { type: 'image', src: 'https://placehold.co/800x600/1a0505/FFF?text=FOTO+24', title: '-', ratio: 'aspect-video' },
            { type: 'image', src: 'https://placehold.co/600x600/1a0505/FFF?text=FOTO+25', title: '-', ratio: 'aspect-square' }
        ];


        function renderMainDocGrid(filter = "") {
            const container = document.getElementById('documentation-grid');
            let html = '';
            
            let itemsToShow = filter ? allFilesData : existingMedia;

            itemsToShow.forEach(item => {
                if (filter && !item.title.toLowerCase().includes(filter.toLowerCase())) return;

                html += createMediaCard(item);
            });

            if(html === '') {
                html = `<div class="col-span-3 text-center text-gray-500 py-10">No media found matching "${filter}"</div>`;
            }
            container.innerHTML = html;
        }

        function renderAllFilesGrid() {
            const container = document.getElementById('all-files-grid');
            let html = '';
            
            allFilesData.forEach(item => {
                html += createMediaCard(item, true); 
            });
            container.innerHTML = html;
        }

        function createMediaCard(item, isSmall = false) {
            const margin = isSmall ? 'mb-4' : 'mb-6'; 
            
            const isLogo = item.ratio === 'aspect-square' && item.title.toLowerCase().includes('logo');
            
            const shapeClass = isLogo 
                ? `rounded-full aspect-square border-4 border-red-600/30 shadow-[0_0_25px_rgba(220,38,38,0.4)]` 
                : `rounded-xl ${item.ratio}`;

            const textPosition = isLogo 
                ? 'inset-0 flex items-end justify-center pb-6' 
                : 'bottom-4 left-4';

            if (item.type === 'video') {
                return `
                <div class="break-inside-avoid relative group ${shapeClass} overflow-hidden glass-panel cursor-pointer ${margin}" onclick="openMediaModal('video', '${item.src}')">
                    <div class="w-full h-full bg-black/50 flex items-center justify-center">
                        ${item.src ? 
                            `<video class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition duration-500" loop muted onmouseenter="previewVideo(this)" onmouseleave="stopPreview(this)">
                                <source src="${item.src}" type="video/mp4">
                             </video>` 
                            : `<i class="fas fa-video text-gray-600 text-4xl"></i>` 
                        }
                    </div>
                    <div class="play-overlay"><i class="fas fa-play"></i></div>
                    <div class="absolute z-10 ${textPosition}">
                        <span class="text-xs font-bold text-white bg-red-600 px-2 py-1 rounded shadow-lg">${item.title}</span>
                    </div>
                </div>`;
            } else {
                return `
                <div class="break-inside-avoid relative group ${shapeClass} overflow-hidden glass-panel cursor-pointer ${margin}" onclick="openMediaModal('image', '${item.src}')">
                    <img src="${item.src}" alt="${item.title}" 
                            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                            onerror="this.src='https://placehold.co/600x800/1a0505/FFF?text=No+Image';">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"></div>
                    <div class="absolute ${textPosition}">
                        <h3 class="text-lg font-bold text-white drop-shadow-md">${item.title}</h3>
                    </div>
                </div>`;
            }
        }

        function initDocumentation() {
            renderMainDocGrid();
        }

        function handleSearch(event) {
            if (event.key === 'Enter' || event.type === 'click' || event.type === 'keyup') {
                const query = document.getElementById('doc-search').value;
                renderMainDocGrid(query);
            }
        }

        function openAllFiles() {
            renderAllFilesGrid();
            const modal = document.getElementById('all-files-overlay');
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
            history.pushState({ page: 'all-files' }, '', '#all-files');
            modal.focus();
        }

        function closeAllFiles() {
             if (history.state && history.state.page === 'all-files') {
                history.back();
                return;
            }
            const modal = document.getElementById('all-files-overlay');
            modal.classList.remove('open');
            document.body.style.overflow = 'auto';
            history.replaceState({ page: 'documentation' }, '', '#documentation');
        }

        window.addEventListener('popstate', function(event) {
            const state = event.state || { page: 'home' };
            
            // CLEAN UP ALL MODALS FIRST
            const bioModal = document.getElementById('bio-modal');
            const mediaModal = document.getElementById('media-modal');
            const familyGallery = document.getElementById('family-gallery');
            const allFilesModal = document.getElementById('all-files-overlay');
            const mediaContainer = document.getElementById('media-container');
            const teamExecutorModal = document.getElementById('team-executor-modal');

            // Force close everything visual
            bioModal.classList.remove('active');
            mediaModal.classList.remove('active');
            familyGallery.classList.remove('open');
            allFilesModal.classList.remove('open');
            teamExecutorModal.classList.remove('open');
            mediaContainer.innerHTML = '';
            document.body.style.overflow = 'auto'; // Re-enable scroll

            // Now handle specific state logic if strictly needed, or just let the main tab switch happen
            if (['home', 'structure', 'documentation', 'finance'].includes(state.page)) {
                _switchTabUI(state.page);
            } else if (state.page === 'family-gallery') {
                 familyGallery.classList.add('open');
                 document.body.style.overflow = 'hidden';
            } else if (state.page === 'all-files') {
                 allFilesModal.classList.add('open');
                 document.body.style.overflow = 'hidden';
            } else if (state.page === 'team-executor') {
                 teamExecutorModal.classList.add('open');
                 document.body.style.overflow = 'hidden';
            } else if (state.page === 'bio-details') {
                // If popping back to bio details, we might need data. 
                // For simplicity on back button, let's fall back to family gallery or home if data missing
                 familyGallery.classList.add('open');
                 document.body.style.overflow = 'hidden';
            }
        });

        function toggleFamilyGallery() {
            const gallery = document.getElementById('family-gallery');
            if (gallery.classList.contains('open')) {
                if (history.state && history.state.page === 'family-gallery') {
                    history.back();
                    return;
                }
                gallery.classList.remove('open');
                document.body.style.overflow = 'auto';
                const activeSection = document.querySelector('.active-section');
                // history.replaceState({ page: activeSection ? activeSection.id : 'home' }, '', '#' + (activeSection ? activeSection.id : 'home'));
            } else {
                gallery.classList.add('open');
                document.body.style.overflow = 'hidden';
                history.pushState({ page: 'family-gallery' }, '', '#family');
                gallery.focus();
            }
        }

        function openBioModal(index) {
            const student = studentsData[index];
            const modal = document.getElementById('bio-modal');
            const content = document.getElementById('bio-content');
            
            document.getElementById('modal-name').innerText = student.name;
            document.getElementById('modal-nim').innerText = "NIM: " + student.nim;
            
            const igContainer = document.getElementById('modal-ig');
            if(student.ig === '-' || student.ig === '') {
                igContainer.innerHTML = `<span class="text-gray-500">-</span>`;
            } else {
                const username = student.ig.replace('@', '').trim();
                igContainer.innerHTML = `<a href="https://www.instagram.com/${username}" target="_blank" rel="noopener noreferrer" class="text-lg text-white font-medium hover:text-red-400 transition cursor-pointer flex items-center gap-1">${student.ig} <i class="fas fa-external-link-alt text-xs ml-1 opacity-50"></i></a>`;
            }
            document.getElementById('modal-bio').innerText = `"${student.bio}"`;
            const imgElement = document.getElementById('modal-img');
            const loaderElement = document.getElementById('modal-img-loader');
            imgElement.classList.remove('img-loaded');
            imgElement.style.opacity = '0';
            loaderElement.style.display = 'flex'; 
            imgElement.onload = function() {
                imgElement.style.opacity = '1';
                loaderElement.style.display = 'none'; 
            };
            imgElement.onerror = function() {
                this.onerror = null;
                this.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(student.name)}&background=random&size=400`;
                imgElement.style.opacity = '1';
                loaderElement.style.display = 'none';
            };
            imgElement.src = student.bioImg;

            modal.classList.add('active');
            content.classList.remove('scale-95');
            content.classList.add('scale-100');
            history.pushState({ page: 'bio-details' }, '', '#student-bio');
            
            setTimeout(() => {
                content.focus();
            }, 100);
        }

        function closeBioModal(e, force = false) {
            if (e && !force) {
                const content = document.getElementById('bio-content');
                if (content.contains(e.target)) return;
            }

            if (history.state && history.state.page === 'bio-details') {
                history.back();
                return;
            }
            document.getElementById('bio-modal').classList.remove('active');
        }

        function openMediaModal(type, src) {
            if(!src) return;

            if (type === 'video') {
                const bgMusic = document.getElementById('bg-music');
                if (bgMusic && !bgMusic.paused) {
                    bgMusic.pause();
                    bgMusic.dataset.wasPlaying = "true";
                }
            }
            const modal = document.getElementById('media-modal');
            const container = document.getElementById('media-container');
            
            if (type === 'video') {
                container.innerHTML = `
                    <div class="bg-black w-full h-full flex items-center justify-center">
                        <video controls autoplay class="w-full h-auto max-h-[85vh]">
                            <source src="${src}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>`;
                container.dataset.mediaType = 'video';
            } else {
                container.innerHTML = `
                    <img src="${src}" class="w-full h-auto max-h-[85vh] object-contain bg-black" onerror="this.src='https://placehold.co/600x400?text=Image+Not+Found';">
                `;
                container.dataset.mediaType = 'image';
            }
            modal.classList.add('active');
            history.pushState({ page: 'media-preview' }, '', '#preview');
        }

        function closeMediaModal(e, force = false) {
            if (e && !force) {
                 const container = document.getElementById('media-container');
                 if (container.contains(e.target)) return;
            }

            // CRITICAL FIX: If user is in preview state, go back instead of replacing state
            if (history.state && history.state.page === 'media-preview') {
                history.back();
                return;
            }

            // Fallback cleanup if state is mismatched
            const container = document.getElementById('media-container');
            if (container.dataset.mediaType === 'video') {
                 const bgMusic = document.getElementById('bg-music');
                 const musicBtn = document.getElementById('music-btn'); 
                 if (bgMusic && bgMusic.dataset.wasPlaying === "true") {
                     bgMusic.play().catch(e => console.log(e));
                     if(musicBtn) {
                         musicBtn.innerHTML = '<i class="fas fa-music"></i>';
                         musicBtn.classList.add('music-pulse');
                         isPlaying = true;
                     }
                 }
            }
            container.innerHTML = ''; 
            document.getElementById('media-modal').classList.remove('active');
        }
        
        function previewVideo(video) {
            video.muted = true;
            var playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {}).catch(error => { if (error.name !== 'AbortError') console.log("Prev prevented"); });
            }
        }

        function stopPreview(video) {
            video.pause();
            video.currentTime = 0; 
        }

        function switchTab(tabId) {
            // 1. Show Loader
            const loader = document.getElementById('page-loader');
            loader.classList.remove('opacity-0', 'pointer-events-none');
            loader.classList.add('active'); 

            // 2. Wait for visual effect
            setTimeout(() => {
                // 3. Switch UI (The existing logic)
                _switchTabUI(tabId);
                
                // 4. Scroll to top
                window.scrollTo(0, 0);
                
                // 5. Update History
                history.pushState({ page: tabId }, '', '#' + tabId);
                
                // 6. Hide Loader after a slight delay
                setTimeout(() => {
                    loader.classList.remove('active');
                    loader.classList.add('opacity-0', 'pointer-events-none');
                }, 300);
                
            }, 500); 
        }

        function _switchTabUI(tabId) {
            const sections = document.querySelectorAll('main section');
            sections.forEach(section => {
                section.classList.remove('active-section');
                section.classList.add('hidden-section');
                section.style.display = 'none'; 
            });

            const target = document.getElementById(tabId);
            if (target) {
                if (tabId === 'finance') {
                    target.style.display = 'flex';
                } else {
                    target.style.display = 'block';
                }
                
                requestAnimationFrame(() => {
                    target.classList.remove('hidden-section');
                    target.classList.add('active-section');
                });
            }
            
            // Close mobile menu if open
            const menu = document.getElementById('mobile-menu');
             if (menu.classList.contains('max-h-screen')) {
                toggleMobileMenu();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            if (menu.classList.contains('max-h-0')) {
                // Open
                menu.classList.remove('max-h-0', 'opacity-0');
                menu.classList.add('max-h-screen', 'opacity-100');
            } else {
                // Close
                menu.classList.remove('max-h-screen', 'opacity-100');
                menu.classList.add('max-h-0', 'opacity-0');
            }
        }
    </script>
</body>
</html>

